"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[6624],{8372:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>u,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var n=t(5893),l=t(1151),r=t(4866),o=t(5162);const i={sidebar_position:1,title:"Registering your interoperable tables across multiple catalogs"},s="Registering your interoperable tables across multiple catalogs",c={id:"how-to-catalog-sync",title:"Registering your interoperable tables across multiple catalogs",description:"Using Apache XTable\u2122 (Incubating) to sync your source tables across multiple target catalogs involves running catalog sync on your",source:"@site/docs/how-to-catalog-sync.md",sourceDirName:".",slug:"/how-to-catalog-sync",permalink:"/docs/how-to-catalog-sync",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Registering your interoperable tables across multiple catalogs"},sidebar:"docs",previous:{title:"Creating your first interoperable table",permalink:"/docs/how-to"},next:{title:"Catalogs",permalink:"/docs/catalogs-index"}},u={},d=[{value:"Pre-requisites",id:"pre-requisites",level:2},{value:"Steps",id:"steps",level:2},{value:"Running catalog sync",id:"running-catalog-sync",level:3},{value:"Conclusion",id:"conclusion",level:2}];function g(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h1,{id:"registering-your-interoperable-tables-across-multiple-catalogs",children:"Registering your interoperable tables across multiple catalogs"}),"\n",(0,n.jsx)(a.admonition,{title:"Important",type:"danger",children:(0,n.jsxs)(a.p,{children:["Using Apache XTable\u2122 (Incubating) to sync your source tables across multiple target catalogs involves running catalog sync on your\ncurrent dataset using a bundled jar. You can create this bundled jar by following the instructions\non the ",(0,n.jsx)(a.a,{href:"/docs/setup",children:"Installation page"}),". Read through Apache XTable\u2122's\n",(0,n.jsx)(a.a,{href:"https://github.com/apache/incubator-xtable#building-the-project-and-running-tests",children:"GitHub page"})," for more information."]})}),"\n",(0,n.jsx)(a.p,{children:"In this tutorial, we\u2019ll show you how to use Apache XTable\u2122 (Incubating) to enable interoperability between catalogs.\nFor example, you can expose a Hudi, Iceberg, or Delta table in Hive Metastore (HMS) and make it available in the AWS Glue Data Catalog\u2014without manually registering each table.\nAdditionally, Apache XTable\u2122 (Incubating) allows you to convert the table format metadata. For instance, a Delta table in HMS can be exposed as an Iceberg table in Glue."}),"\n",(0,n.jsx)(a.h2,{id:"pre-requisites",children:"Pre-requisites"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["Source table(s) (Hudi/Delta/Iceberg) already written to your local storage or external storage locations like S3/GCS/ADLS.\nIf you don't have the source table written in place already, you can follow the steps in this ",(0,n.jsx)(a.a,{href:"/docs/how-to#create-dataset",children:"tutorial"})," to set it up."]}),"\n",(0,n.jsxs)(a.li,{children:["Clone the Apache XTable\u2122 (Incubating) ",(0,n.jsx)(a.a,{href:"https://github.com/apache/incubator-xtable",children:"repository"})," and create the\n",(0,n.jsx)(a.code,{children:"xtable-utilities_2.12-0.2.0-SNAPSHOT-bundled.jar"})," by following the steps on the ",(0,n.jsx)(a.a,{href:"/docs/setup",children:"Installation page"})]}),"\n",(0,n.jsx)(a.li,{children:"Hive Metastore is configured and running\u2014either locally or on platforms like EMR, Dataproc, or HDInsight."}),"\n",(0,n.jsxs)(a.li,{children:["Setup access to interact with AWS APIs from the command line.\nIf you haven\u2019t installed AWSCLIv2, you do so by following the steps outlined in\n",(0,n.jsx)(a.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html",children:"AWS docs"})," and\nalso set up access credentials by following the steps\n",(0,n.jsx)(a.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-quickstart.html",children:"here"})]}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"In the next steps, we\u2019ll walk through how to run Apache XTable\u2122 (Incubating) locally to sync your tables from a source catalog to multiple target catalogs."}),"\n",(0,n.jsx)(a.h2,{id:"steps",children:"Steps"}),"\n",(0,n.jsx)(a.h3,{id:"running-catalog-sync",children:"Running catalog sync"}),"\n",(0,n.jsxs)(a.p,{children:["Create ",(0,n.jsx)(a.code,{children:"my_config_catalog.yaml"})," in the cloned xtable directory."]}),"\n",(0,n.jsxs)(r.Z,{groupId:"source-catalog",defaultValue:"hms",values:[{label:"sourceCatalog: HMS",value:"hms"},{label:"sourceCatalog: GLUE",value:"glue"},{label:"sourceCatalog: STORAGE",value:"storage"}],children:[(0,n.jsx)(o.Z,{value:"hms",children:(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-yaml",metastring:'md title="yaml"',children:'sourceCatalog:\n   catalogId: "source-catalog-id"\n   catalogType: "HMS"\n   catalogProperties:\n      # Ex: thrift://localhost:9083\n      # Checkout org.apache.xtable.hms.HMSCatalogConfig for advanced configs.\n      externalCatalog.hms.serverUrl: "hms-server-url"\n\ntargetCatalogs:\n   - catalogId: "target-catalog-id-glue"\n     catalogSyncClientImpl: "org.apache.xtable.glue.GlueCatalogSyncClient"\n     catalogProperties:\n        # Checkout org.apache.xtable.glue.GlueCatalogConfig for advanced configs. \n        externalCatalog.glue.region: "aws-region"\n\ndatasets:\n   - sourceCatalogTableIdentifier:\n        tableIdentifier:\n           hierarchicalId: "db.hudi_table"\n           # you only need to specify partitionSpec for HUDI sourceFormat\n           partitionSpec: "cs_sold_date_sk:VALUE"\n     targetCatalogTableIdentifiers:\n        - catalogId: "target-catalog-id-hms"\n          tableFormat: "ICEBERG"\n          tableIdentifier:\n             hierarchicalId: "db.iceberg_table"\n        - catalogId: "target-catalog-id-hms"\n          tableFormat: "DELTA"\n          tableIdentifier:\n             hierarchicalId: "db.delta_table"\n'})})}),(0,n.jsx)(o.Z,{value:"glue",children:(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-yaml",metastring:'md title="yaml"',children:'sourceCatalog:\n  catalogId: "source-catalog-id"\n  catalogType: "GLUE"\n  catalogProperties:\n    # Checkout org.apache.xtable.glue.GlueCatalogConfig for advanced configs.\n    externalCatalog.glue.region: "aws-region"\n\ntargetCatalogs:\n  - catalogId: "target-catalog-id-hms"\n    catalogSyncClientImpl: "org.apache.xtable.hms.HMSCatalogSyncClient"\n    catalogProperties:\n      # Ex: thrift://localhost:9083\n      # Checkout org.apache.xtable.hms.HMSCatalogConfig for advanced configs.\n      externalCatalog.hms.serverUrl: "hms-server-url"\n\ndatasets:\n  - sourceCatalogTableIdentifier:\n      tableIdentifier:\n        hierarchicalId: "db.iceberg_table"\n    targetCatalogTableIdentifiers:\n      - catalogId: "target-catalog-id-hms"\n        tableFormat: "DELTA"\n        tableIdentifier:\n          hierarchicalId: "db.delta_table"\n      - catalogId: "target-catalog-id-hms"\n        tableFormat: "HUDI"\n        tableIdentifier:\n          hierarchicalId: "db.hudi_table"\n'})})}),(0,n.jsx)(o.Z,{value:"storage",children:(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-yaml",metastring:'md title="yaml"',children:'sourceCatalog:\n   catalogId: "source-catalog-id"\n   catalogType: "STORAGE"\n   catalogProperties: {}\n\ntargetCatalogs:\n   - catalogId: "target-catalog-id-glue"\n     catalogSyncClientImpl: "org.apache.xtable.glue.GlueCatalogSyncClient"\n     catalogProperties:\n        # Checkout org.apache.xtable.glue.GlueCatalogConfig for advanced configs.\n        externalCatalog.glue.region: "aws-region"\n\n   - catalogId: "target-catalog-id-hms"\n     catalogSyncClientImpl: "org.apache.xtable.hms.HMSCatalogSyncClient"\n     catalogProperties:\n        # Ex: thrift://localhost:9083\n        # Checkout org.apache.xtable.hms.HMSCatalogConfig for advanced configs.\n        externalCatalog.hms.serverUrl: "hms-server-url" \n\ndatasets:\n   - sourceCatalogTableIdentifier:\n        storageIdentifier:\n           tableBasePath: file:///path/to/hudi/source/data\n           tableName: table_name\n           # you only need to specify partitionSpec for HUDI sourceFormat\n           partitionSpec: partitionpath:VALUE\n           tableFormat: "HUDI"\n\n     targetCatalogTableIdentifiers:\n        - catalogId: "target-catalog-id-glue"\n          tableFormat: "DELTA"\n          tableIdentifier:\n             hierarchicalId: "db.delta_table"\n\n        - catalogId: "target-catalog-id-hms"\n          tableFormat: "DELTA"\n          tableIdentifier:\n             hierarchicalId: "db.delta_table"\n\n        - catalogId: "target-catalog-id-glue"\n          tableFormat: "ICEBERG"\n          tableIdentifier:\n             hierarchicalId: "db.iceberg_table"\n\n        - catalogId: "target-catalog-id-hms"\n          tableFormat: "ICEBERG"\n          tableIdentifier:\n             hierarchicalId: "db.iceberg_table"\n'})})})]}),"\n",(0,n.jsx)(a.admonition,{title:"Note:",type:"note",children:(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"catalogId"})," is a user defined unique identifier for each catalog, useful if you want to sync a table to multiple glue/hms catalogs."]}),"\n",(0,n.jsxs)(a.li,{children:["Replace with appropriate values for ",(0,n.jsx)(a.code,{children:"hierarchicalId"}),", a 2-part or 3-part tableIdentifier."]}),"\n",(0,n.jsxs)(a.li,{children:["For storage catalog, replace ",(0,n.jsx)(a.code,{children:"file:///path/to/source/data"})," to appropriate ",(0,n.jsx)(a.code,{children:"tableBasePath"}),"\nif you have your source table in S3/GCS/ADLS i.e.","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["S3 - ",(0,n.jsx)(a.code,{children:"s3://path/to/source/data"})]}),"\n",(0,n.jsxs)(a.li,{children:["GCS - ",(0,n.jsx)(a.code,{children:"gs://path/to/source/data"})," or"]}),"\n",(0,n.jsxs)(a.li,{children:["ADLS - ",(0,n.jsx)(a.code,{children:"abfss://<container-name>@<storage-account-name>.dfs.core.windows.net/<path-to-data>"})]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["For advanced configurations checkout java docs for ",(0,n.jsx)(a.a,{href:"https://github.com/apache/incubator-xtable/blob/main/xtable-aws/src/main/java/org/apache/xtable/glue/GlueCatalogConfig.java",children:(0,n.jsx)(a.strong,{children:"GlueCatalogConfig"})})," and ",(0,n.jsx)(a.a,{href:"https://github.com/apache/incubator-xtable/blob/main/xtable-hive-metastore/src/main/java/org/apache/xtable/hms/HMSCatalogConfig.java",children:(0,n.jsx)(a.strong,{children:"HMSCatalogConfig"})}),"."]}),"\n"]})}),"\n",(0,n.jsx)(a.admonition,{title:"Note:",type:"note",children:(0,n.jsxs)(a.p,{children:["Authentication for AWS is done with ",(0,n.jsx)(a.code,{children:"com.amazonaws.auth.DefaultAWSCredentialsProviderChain"}),".\nTo override this setting, specify a different implementation with the ",(0,n.jsx)(a.code,{children:"--awsCredentialsProvider"})," option."]})}),"\n",(0,n.jsx)(a.p,{children:"In your terminal under the cloned Apache XTable\u2122 (Incubating) directory, run the below command."}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",metastring:'md title="shell"',children:"java -cp xtable-utilities/target/xtable-utilities_2.12-0.2.0-SNAPSHOT-bundled.jar org.apache.xtable.utilities.RunCatalogSync --catalogSyncConfig my_config_catalog.yaml\n"})}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Optional:"}),"\nNow, if you check your target catalog, you'll see the external tables have been created and are ready to be queried."]}),"\n",(0,n.jsx)(a.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsx)(a.p,{children:"In this tutorial, we explored how to set up Apache XTable\u2122 (Incubating) to automatically read tables from a source catalog and create interoperable external tables in target catalogs.\nOnce synced, these tables are immediately queryable from the target catalog without manual registration."})]})}function h(e={}){const{wrapper:a}={...(0,l.a)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(g,{...e})}):g(e)}},5162:(e,a,t)=>{t.d(a,{Z:()=>o});t(7294);var n=t(6010);const l={tabItem:"tabItem_Ymn6"};var r=t(5893);function o(e){let{children:a,hidden:t,className:o}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,n.Z)(l.tabItem,o),hidden:t,children:a})}},4866:(e,a,t)=>{t.d(a,{Z:()=>j});var n=t(7294),l=t(6010),r=t(2466),o=t(6550),i=t(469),s=t(1980),c=t(7392),u=t(12);function d(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:a}=e;return!!a&&"object"==typeof a&&"value"in a}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function g(e){const{values:a,children:t}=e;return(0,n.useMemo)((()=>{const e=a??function(e){return d(e).map((e=>{let{props:{value:a,label:t,attributes:n,default:l}}=e;return{value:a,label:t,attributes:n,default:l}}))}(t);return function(e){const a=(0,c.l)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,t])}function h(e){let{value:a,tabValues:t}=e;return t.some((e=>e.value===a))}function b(e){let{queryString:a=!1,groupId:t}=e;const l=(0,o.k6)(),r=function(e){let{queryString:a=!1,groupId:t}=e;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:a,groupId:t});return[(0,s._X)(r),(0,n.useCallback)((e=>{if(!r)return;const a=new URLSearchParams(l.location.search);a.set(r,e),l.replace({...l.location,search:a.toString()})}),[r,l])]}function p(e){const{defaultValue:a,queryString:t=!1,groupId:l}=e,r=g(e),[o,s]=(0,n.useState)((()=>function(e){let{defaultValue:a,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!h({value:a,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${a}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return a}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:a,tabValues:r}))),[c,d]=b({queryString:t,groupId:l}),[p,m]=function(e){let{groupId:a}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(a),[l,r]=(0,u.Nk)(t);return[l,(0,n.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:l}),f=(()=>{const e=c??p;return h({value:e,tabValues:r})?e:null})();(0,i.Z)((()=>{f&&s(f)}),[f]);return{selectedValue:o,selectValue:(0,n.useCallback)((e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);s(e),d(e),m(e)}),[d,m,r]),tabValues:r}}var m=t(2389);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(5893);function y(e){let{className:a,block:t,selectedValue:n,selectValue:o,tabValues:i}=e;const s=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.o5)(),u=e=>{const a=e.currentTarget,t=s.indexOf(a),l=i[t].value;l!==n&&(c(a),o(l))},d=e=>{let a=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=s.indexOf(e.currentTarget)+1;a=s[t]??s[0];break}case"ArrowLeft":{const t=s.indexOf(e.currentTarget)-1;a=s[t]??s[s.length-1];break}}a?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":t},a),children:i.map((e=>{let{value:a,label:t,attributes:r}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:n===a?0:-1,"aria-selected":n===a,ref:e=>s.push(e),onKeyDown:d,onClick:u,...r,className:(0,l.Z)("tabs__item",f.tabItem,r?.className,{"tabs__item--active":n===a}),children:t??a},a)}))})}function v(e){let{lazy:a,children:t,selectedValue:l}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(a){const e=r.find((e=>e.props.value===l));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map(((e,a)=>(0,n.cloneElement)(e,{key:a,hidden:e.props.value!==l})))})}function I(e){const a=p(e);return(0,x.jsxs)("div",{className:(0,l.Z)("tabs-container",f.tabList),children:[(0,x.jsx)(y,{...e,...a}),(0,x.jsx)(v,{...e,...a})]})}function j(e){const a=(0,m.Z)();return(0,x.jsx)(I,{...e,children:d(e.children)},String(a))}},1151:(e,a,t)=>{t.d(a,{Z:()=>i,a:()=>o});var n=t(7294);const l={},r=n.createContext(l);function o(e){const a=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),n.createElement(r.Provider,{value:a},e.children)}}}]);